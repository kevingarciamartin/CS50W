{% extends 'auctions/layout.html' %}

{% block title %}
    Watchlist - Auctions
{% endblock title %}

{% block body %}
    <div class="d-flex gap align-center">
        <h2>Watchlist</h2>
        <form action="{% url 'category_watchlist' %}" method="POST" class="category-form">
            {% csrf_token %}
            <select name="category" id="active-listings-category">
                <option value="all">All Categories</option>
                {% for category in categories %}
                    <option value="{{ category }}">{{ category }}</option>
                {% endfor %}
            </select>
            <input type="submit" value="Filter">
        </form>
    </div>
    <div class="grid gap">
        {% for listing in watchlist %}
            <a href="{% url 'listing' listing.id %}" class="listing card-grid">
                <img src="{{ listing.image }}" alt="{{ listing.item }}">
                <div>
                    <h3>{{ listing.item }}</h3>
                    {% if listing.number_of_bids == 0 %}
                        <p><strong>
                            ${{ listing.listing_price }}
                            {% if not listing.isActive %}
                                - SOLD
                            {% endif %}
                        </strong></p>
                    {% else %}
                        <p><strong>
                            ${{ listing.highest_bid.bid }}
                            {% if not listing.isActive %}
                                - SOLD
                            {% endif %}
                        </strong></p>
                    {% endif %}
                    <p>{{ listing.description }}</p>
                    <div>Created {{ listing.timestamp }}</div>
                    <div>by {{ listing.lister }}</div>
                </div>
            </a>
        {% empty %}
            <h4>No listings.</h3>
        {% endfor %}
    </div>
{% endblock body %}